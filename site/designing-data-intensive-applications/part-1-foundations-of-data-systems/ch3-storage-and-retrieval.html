
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storage and Retrieval Techniques for Database Systems | Elijah's Notes</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Explores various storage and retrieval techniques for database systems, including log-structured storage, indexing methods, and optimizations. Compares OLTP and OLAP systems, discussing their respective storage strategies and performance considerations.">
    <meta name="author" content="Elijah Melton">
    <meta name="robots" content="index, follow">
    <meta name="generator" content="Custom Static Site Generator">
    <link rel="canonical" href="https://notes.elimelt.com/designing-data-intensive-applications/part-1-foundations-of-data-systems/ch3-storage-and-retrieval.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Storage and Retrieval Techniques for Database Systems">
    <meta property="og:description" content="Explores various storage and retrieval techniques for database systems, including log-structured storage, indexing methods, and optimizations. Compares OLTP and OLAP systems, discussing their respective storage strategies and performance considerations.">
    <meta property="og:url" content="https://notes.elimelt.com/designing-data-intensive-applications/part-1-foundations-of-data-systems/ch3-storage-and-retrieval.html">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Storage and Retrieval Techniques for Database Systems">
    <meta name="twitter:description" content="Explores various storage and retrieval techniques for database systems, including log-structured storage, indexing methods, and optimizations. Compares OLTP and OLAP systems, discussing their respective storage strategies and performance considerations.">

    <meta name="keywords" content="data structures,indexing,oltp vs olap,column-oriented storage">

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {"@context": "https://schema.org", "@type": "Article", "headline": "Storage and Retrieval Techniques for Database Systems", "dateModified": "2025-01-01T04:29:39.285544", "description": "Explores various storage and retrieval techniques for database systems, including log-structured storage, indexing methods, and optimizations. Compares OLTP and OLAP systems, discussing their respective storage strategies and performance considerations.", "articleSection": "Database Systems", "keywords": "data structures,indexing,oltp vs olap,column-oriented storage"}
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js"></script>

    <!-- Configure KaTeX auto-render -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "\[", right: "\]", display: true},
                    {left: "$", right: "$", display: false},
                ],
                preProcess: (math) => {
                    console.log("Pre-processing: " + math);
                    math = math.split("\n").map((line) => {
                        if (line.endsWith("\\")) {
                            return line + "\\";
                        }
                        return line;
                    }).join("\n");
                    return math;
                },
                throwOnError: false
            });
        });
    </script>

<style>

/* Taxonomy Pages Enhancement - Add this to your existing CSS */

/* Taxonomy List Container */
.taxonomy-container {
    margin: var(--spacing-lg) 0;
}

/* Alphabet Jump Navigation */
.alphabet-nav {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: var(--spacing-lg);
    position: sticky;
    top: 60px; /* Adjust based on your nav height */
    background: var(--background-color);
    padding: var(--spacing-sm) 0;
    z-index: 10;
    border-bottom: 1px solid var(--border-color);
}

.alphabet-nav a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    border-radius: var(--radius-sm);
    background: var(--border-color);
    text-decoration: none;
    font-weight: 500;
    transition: all var(--transition-speed);
}

.alphabet-nav a:hover, .alphabet-nav a:focus {
    background: var(--accent-color);
    color: white;
}

.alphabet-nav a.empty {
    opacity: 0.4;
    cursor: default;
}

.alphabet-nav a.empty:hover {
    background: var(--border-color);
    color: var(--text-color);
}

/* Alphabet Section */
.alphabet-section {
    margin-bottom: var(--spacing-lg);
    scroll-margin-top: 120px; /* Ensures the section isn't hidden behind sticky elements */
}

.alphabet-section h2 {
    font-size: 1.8rem;
    padding-bottom: var(--spacing-sm);
    margin-bottom: var(--spacing-md);
    border-bottom: 2px solid var(--accent-color);
    color: var(--accent-color);
}

/* Enhanced List Styling */
.taxonomy-list {
    list-style: none;
    padding: 0;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: var(--spacing-md);
}

.taxonomy-list li {
    display: flex;
    align-items: center;
    padding: var(--spacing-sm);
    border-radius: var(--radius-sm);
    background: var(--accent-light);
    transition: all var(--transition-speed);
}

.taxonomy-list li:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.taxonomy-list a {
    flex: 1;
    display: block;
    text-decoration: none;
    font-weight: 500;
}

.taxonomy-list .count {
    background: var(--accent-color);
    color: white;
    padding: 0.1rem 0.5rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 700;
}

/* Search Box */
.taxonomy-search {
    margin-bottom: var(--spacing-lg);
    width: 100%;
}

.search-container {
    position: relative;
}

.search-container input {
    width: 100%;
    padding: var(--spacing-md);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    background: var(--background-color);
    color: var(--text-color);
    font-size: 1rem;
    transition: all var(--transition-speed);
}

.search-container input:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px var(--accent-light);
}

.search-icon {
    position: absolute;
    right: var(--spacing-md);
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-color);
    opacity: 0.5;
}

/* No Results Message */
.no-results {
    padding: var(--spacing-lg);
    text-align: center;
    background: var(--border-color);
    border-radius: var(--radius-md);
    margin: var(--spacing-lg) 0;
}

/* Tag Cloud for Tags Page */
.tag-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
    margin: var(--spacing-lg) 0;
}

.tag-cloud a {
    display: inline-block;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-sm);
    background: var(--border-color);
    color: var(--text-color);
    text-decoration: none;
    transition: all var(--transition-speed);
    margin-bottom: var(--spacing-sm);
}

.tag-cloud a:hover {
    background: var(--accent-color);
    color: white;
    transform: translateY(-2px);
}

/* Tag sizes based on frequency */
.tag-xs { font-size: 0.8rem; }
.tag-sm { font-size: 0.9rem; }
.tag-md { font-size: 1rem; }
.tag-lg { font-size: 1.2rem; }
.tag-xl { font-size: 1.5rem; }

/* Category Summary Cards */
.category-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--spacing-md);
    margin: var(--spacing-lg) 0;
}

.category-card {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    transition: all var(--transition-speed);
    background: var(--background-color);
}

.category-card:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-md);
    border-color: var(--accent-color);
}

.category-card h3 {
    margin-top: 0;
    margin-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--border-color);
    padding-bottom: var(--spacing-sm);
}

.category-card .page-count {
    color: var(--accent-color);
    font-weight: bold;
}

.category-card .sample-pages {
    margin-top: var(--spacing-sm);
    font-size: 0.9rem;
}

.category-card .sample-pages a {
    display: block;
    margin-bottom: var(--spacing-sm);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.category-card .view-all {
    display: block;
    text-align: right;
    margin-top: var(--spacing-sm);
    font-weight: 500;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .taxonomy-list {
        grid-template-columns: 1fr;
    }

    .alphabet-nav {
        gap: 0.3rem;
    }

    .alphabet-nav a {
        width: 1.8rem;
        height: 1.8rem;
        font-size: 0.9rem;
    }

    .category-cards {
        grid-template-columns: 1fr;
    }
}

/* Dark mode adjustments */
@media (prefers-color-scheme: dark) {
    .taxonomy-list li {
        background: rgba(96, 165, 250, 0.1);
    }

    .category-card {
        background: var(--background-color);
    }
}

/* Animation for items appearing when filtering */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.taxonomy-list li {
    animation: fadeIn 0.3s ease-out;
}

/* Google Fonts Import */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:ital,wght@0,400;0,700;1,400;1,700&display=swap');

/* Base Typography Settings */
.content {
    /* Layout and spacing */
    margin-top: 2rem;
    max-width: 70ch;
    margin-left: auto;
    margin-right: auto;
    padding: 0 1.5rem;

    /* Base font settings */
    font-family: 'Merriweather', Georgia, serif;
    font-size: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);
    line-height: 1.75;
    font-weight: 400;

    /* Color and contrast */
    color: rgba(0, 0, 0, 0.87);
    background-color: #fff;

    /* Text rendering */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;

    /* Better spacing */
    letter-spacing: 0.01em;
    word-spacing: 0.05em;

    /* Hyphenation for better text flow */
    hyphens: auto;
    -webkit-hyphens: auto;
    -ms-hyphens: auto;
}

/* Heading Typography */
.content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-weight: 700;
    line-height: 1.3;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    color: rgba(0, 0, 0, 0.9);
}

.content h1 {
    font-size: clamp(1.75rem, 1.3rem + 2.25vw, 2.5rem);
    letter-spacing: -0.02em;
}

.content h2 {
    font-size: clamp(1.5rem, 1.2rem + 1.5vw, 2rem);
    letter-spacing: -0.015em;
}

.content h3 {
    font-size: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
    letter-spacing: -0.01em;
}

/* Paragraph spacing */
.content p {
    margin-bottom: 1.5rem;
}

.content p + p {
    text-indent: 0.5rem; /* Optional: slight indent for paragraphs after other paragraphs */
}

/* Links with advanced styling */
.content a {
    color: #0366d6;
    text-decoration: none;
    background-image: linear-gradient(transparent calc(100% - 2px), currentColor 2px);
    background-size: 0% 100%;
    background-repeat: no-repeat;
    transition: background-size 0.3s ease-in-out;
}

.content a:hover {
    background-size: 100% 100%;
}

/* Lists with improved spacing */
.content ul, .content ol {
    padding-left: 1.75rem;
    margin-bottom: 1.5rem;
}

.content li {
    margin-bottom: 0.5rem;
}

/* Blockquotes with elegant styling */
.content blockquote {
    margin: 2rem 0;
    padding: 1rem 1.5rem;
    border-left: 4px solid rgba(0, 0, 0, 0.1);
    background-color: rgba(0, 0, 0, 0.02);
    font-style: italic;
    color: rgba(0, 0, 0, 0.75);
}

.content blockquote p:last-child {
    margin-bottom: 0;
}

/* Code blocks */
.content pre, .content code {
    font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
    font-size: 0.9em;
    background-color: rgba(0, 0, 0, 0.04);
    border-radius: 3px;
}

.content code {
    padding: 0.2em 0.4em;
}

.content pre {
    padding: 1rem;
    overflow-x: auto;
    margin: 1.5rem 0;
}

/* Images */
.content img {
    max-width: 100%;
    height: auto;
    border-radius: 4px;
    display: block;
    margin: 2rem auto;
}

/* Tables */
.content table {
    width: 100%;
    border-collapse: collapse;
    margin: 2rem 0;
    font-size: 0.95em;
}

.content th, .content td {
    padding: 0.75rem;
    border: 1px solid rgba(0, 0, 0, 0.1);
}

.content th {
    background-color: rgba(0, 0, 0, 0.03);
    font-weight: 600;
    text-align: left;
}

/* Figure and captions */
.content figure {
    margin: 2rem 0;
}

.content figcaption {
    margin-top: 0.5rem;
    font-size: 0.875rem;
    color: rgba(0, 0, 0, 0.6);
    text-align: center;
    font-family: 'Inter', sans-serif;
}

/* Advanced features for better reading */
@media (min-width: 768px) {
    .content {
        /* Better paragraph rhythm using CSS Grid */
        display: grid;
        grid-template-columns: minmax(0, 1fr);
        row-gap: 0rem;

        /* Drop cap for first paragraph */
    }

    .markdown-content p:first-of-type::first-letter {
        float: left;
        font-size: 3.5em;
        line-height: 0.8;
        padding-right: 0.1em;
        font-weight: 700;
    }

    /* Improve reading with advanced CSS columns for certain elements */
    .content .two-column {
        column-count: 2;
        column-gap: 2.5rem;
        column-rule: 1px solid rgba(0, 0, 0, 0.1);
    }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
    .content {
        color: rgba(255, 255, 255, 0.87);
        background-color: #1a1a1a;
    }

    .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
        color: rgba(255, 255, 255, 0.95);
    }

    .content a {
        color: #58a6ff;
    }

    .content blockquote {
        border-left-color: rgba(255, 255, 255, 0.2);
        background-color: rgba(255, 255, 255, 0.05);
        color: rgba(255, 255, 255, 0.7);
    }

    .content pre, .content code {
        background-color: rgba(255, 255, 255, 0.1);
    }

    .content th, .content td {
        border-color: rgba(255, 255, 255, 0.1);
    }

    .content th {
        background-color: rgba(255, 255, 255, 0.05);
    }
}

/* High contrast mode for accessibility */
@media (forced-colors: active) {
    .content a {
        background-image: none;
        text-decoration: underline;
    }
}

/* Print styles for better printing experience */
@media print {
    .content {
        font-size: 12pt;
        line-height: 1.5;
        color: #000;
    }

    .content a {
        text-decoration: underline;
        color: #000;
        background-image: none;
    }

    .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
        page-break-after: avoid;
    }

    .content p, .content blockquote, .content ul, .content ol {
        orphans: 3;
        widows: 3;
    }
}

/* Advanced font features */
.content {
    font-feature-settings: 'kern' 1, 'liga' 1, 'calt' 1, 'pnum' 1, 'tnum' 0, 'onum' 1, 'lnum' 0, 'dlig' 0;
}

.content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
    font-feature-settings: 'kern' 1, 'liga' 1, 'calt' 1, 'pnum' 1, 'tnum' 0, 'onum' 0, 'lnum' 1, 'dlig' 1;
}

/* Selection styling */
.content ::selection {
    background-color: rgba(0, 102, 204, 0.2);
    text-shadow: none;
}

:root {
    --text-color: #1a1a1a;
    --background-color: #ffffff;
    --accent-color: #2563eb;
    --accent-light: rgba(37, 99, 235, 0.1);
    --border-color: #e5e7eb;
    --nav-background: rgba(255, 255, 255, 0.95);
    --code-background: #f3f4f6;
    --transition-speed: 0.2s;
    --content-width: 50rem;
    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 2rem;
    --spacing-xl: 3rem;
    --radius-sm: 4px;
    --radius-md: 8px;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
    --shadow-md: 0 4px 6px rgba(0,0,0,0.05), 0 1px 3px rgba(0,0,0,0.1);
}

@media (prefers-color-scheme: dark) {
    :root {
        --text-color: #f3f4f6;
        --background-color: #1a1a1a;
        --accent-color: #60a5fa;
        --accent-light: rgba(96, 165, 250, 0.1);
        --border-color: #374151;
        --nav-background: rgba(26, 26, 26, 0.95);
        --code-background: #2d3748;
    }
}

/* Reset and base styles */
*, *::before, *::after {
    box-sizing: border-box;
}

html {
    font-size: 100%;
    scroll-behavior: smooth;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6;
    max-width: var(--content-width);
    margin: 0 auto;
    padding: var(--spacing-md);
    color: var(--text-color);
    background: var(--background-color);
    transition: background-color var(--transition-speed), color var(--transition-speed);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

@media (min-width: 768px) {
    body {
        padding: var(--spacing-lg);
    }
}

/* Improved navigation */
nav {
    position: sticky;
    top: 0;
    background: var(--nav-background);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border-color);
    padding: var(--spacing-md) 0;
    margin: calc(-1 * var(--spacing-md));
    margin-bottom: var(--spacing-lg);
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
    z-index: 1000;
    width: calc(100% + var(--spacing-md) * 2);
    padding-left: var(--spacing-md);
    padding-right: var(--spacing-md);
    box-shadow: var(--shadow-sm);
}

@media (min-width: 768px) {
    nav {
        margin: calc(-1 * var(--spacing-lg));
        width: calc(100% + var(--spacing-lg) * 2);
        padding-left: var(--spacing-lg);
        padding-right: var(--spacing-lg);
        gap: var(--spacing-md);
    }
}

nav a {
    color: var(--accent-color);
    text-decoration: none;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-sm);
    transition: background-color var(--transition-speed), color var(--transition-speed);
    font-weight: 500;
}

nav a:hover, nav a:focus {
    background-color: var(--accent-light);
    outline: none;
}

nav a:focus-visible {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
}

/* Improved breadcrumbs */
.breadcrumbs {
    margin-bottom: var(--spacing-lg);
    color: var(--text-color);
    opacity: 0.8;
    font-size: 0.9rem;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    align-items: center;
}

.breadcrumbs a {
    color: var(--accent-color);
    text-decoration: none;
    transition: color var(--transition-speed);
}

.breadcrumbs a:hover {
    text-decoration: underline;
}

.breadcrumbs span:not(:last-child)::after {
    content: "/";
    margin-left: 0.5rem;
    opacity: 0.5;
}

/* Article styles */
article {
    margin-bottom: var(--spacing-xl);
}

h1, h2, h3, h4, h5, h6 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-md);
    line-height: 1.3;
    font-weight: 600;
}

h1 {
    font-size: 2rem;
    margin-top: 0;
}

h2 {
    font-size: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border-color);
}

/* Meta information styling */
.meta {
    color: var(--text-color);
    opacity: 0.8;
    font-size: 0.9rem;
    margin-bottom: var(--spacing-lg);
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-md);
    padding-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--border-color);
}

/* Improved code blocks */
code {
    background: var(--code-background);
    padding: 0.2rem 0.4rem;
    border-radius: var(--radius-sm);
    font-size: 0.9em;
    font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
}

pre {
    background: var(--code-background);
    padding: var(--spacing-md);
    border-radius: var(--radius-md);
    overflow-x: auto;
    margin: var(--spacing-lg) 0;
    box-shadow: var(--shadow-sm);
}

pre code {
    background: none;
    padding: 0;
    border-radius: 0;
}

/* Improved links */
a {
    color: var(--accent-color);
    text-decoration: none;
    transition: color var(--transition-speed);
}

a:hover {
    text-decoration: underline;
}

/* Improved image handling */
img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    margin: var(--spacing-lg) 0;
    display: block;
    box-shadow: var(--shadow-md);
}

/* Table improvements */
table {
    width: 100%;
    border-collapse: collapse;
    margin: var(--spacing-lg) 0;
    overflow-x: auto;
    display: block;
    border-radius: var(--radius-sm);
    box-shadow: var(--shadow-sm);
}

@media (min-width: 768px) {
    table {
        display: table;
    }
}

th, td {
    padding: 0.75rem;
    border: 1px solid var(--border-color);
    text-align: left;
}

th {
    background: var(--border-color);
    font-weight: 600;
}

/* Tags styling */
.tags {
    margin-top: var(--spacing-lg);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--border-color);
}

.tags a {
    display: inline-block;
    background: var(--border-color);
    color: var(--text-color);
    padding: 0.2rem 0.6rem;
    border-radius: var(--radius-sm);
    text-decoration: none;
    font-size: 0.9em;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    transition: background-color var(--transition-speed), color var(--transition-speed);
}

.tags a:hover {
    background: var(--accent-color);
    color: white;
    text-decoration: none;
}

/* Footer improvements */
footer {
    margin-top: var(--spacing-xl);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--border-color);
    text-align: center;
    font-size: 0.9rem;
    opacity: 0.8;
}

/* Blockquote styling */
blockquote {
    margin: var(--spacing-lg) 0;
    padding-left: var(--spacing-md);
    border-left: 4px solid var(--accent-color);
    color: var(--text-color);
    opacity: 0.9;
    font-style: italic;
}

/* Improved KaTeX rendering */
.katex-display {
    overflow: auto hidden;
    padding: var(--spacing-md) 0;
    margin: var(--spacing-md) 0;
    background: var(--accent-light);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
}

.katex-display > .katex {
    white-space: normal;
}

.katex {
    font-size: 1.1em;
    line-height: 1.2;
}

.katex-display .katex {
    display: block;
    text-align: center;
}

.katex-display > .katex > .katex-html {
    display: block;
    max-width: 100%;
    overflow-x: auto;
    padding: 0.5em 0;
    min-height: 40px;
}

/* Index page styling */
.landing-stats {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    justify-content: space-around;
}

.stat-item {
    text-align: center;
    padding: var(--spacing-md);
    flex: 1;
}

.stat-value {
    display: block;
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--accent-color);
}

.stat-label {
    font-size: 0.9rem;
    opacity: 0.8;
}

/* Base styles for all screen sizes */
.landing-grid {
    margin: 0 auto;
    padding: 1rem;
    max-width: 1200px;
}

/* Stats section styling */
.stats-section {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

.stat-item {
    padding: .5rem;
    text-align: center;
    width: 30%;
}

.stat-number {
    color: #4a88cf;
    font-size: 1.5rem;
    font-weight: bold;
}

.stat-label {
    color: #888;
    font-size: 0.9rem;
}


h2 {
    border-bottom: 1px solid #333;
    padding-bottom: 0.5rem;
    margin-top: 0;
}

/* Recent posts list */
.recent-posts, .categories-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.recent-posts li {
    border-bottom: 1px solid #333;
    padding: 0.75rem 0;
}

.recent-posts li:last-child {
    border-bottom: none;
}

.date, .category {
    color: #888;
    font-size: 0.8rem;
    margin-right: 0.5rem;
}

.category {
    background-color: #3a5e8c;
    border-radius: 3px;
    color: #fff;
    padding: 2px 6px;
}

/* Tags cloud */
.tags-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.tags-cloud a {
    background-color: #3a5e8c;
    border-radius: 3px;
    color: #fff;
    display: inline-block;
    font-size: 0.85rem;
    padding: 0.3rem 0.5rem;
}

/* MOBILE LAYOUT (default) */
.content-area, .sidebar-area {
    width: 100%;
}

/* DESKTOP LAYOUT */
@media (min-width: 768px) {
    .landing-grid {
        display: flex;
        flex-wrap: wrap;
    }

    .stats-section {
        width: 100%;
    }

    .content-area {
        flex: 2;
        margin-right: 1.5rem;
    }

    .sidebar-area {
        flex: 1;
    }

    .recent-section {
        height: 100%;
    }
}

.recent-posts, .categories-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.recent-posts li, .categories-list li {
    padding: var(--spacing-sm) 0;
    border-bottom: 1px solid var(--border-color);
}

.recent-posts li:last-child, .categories-list li:last-child {
    border-bottom: none;
}

.recent-posts .date, .recent-posts .category, .categories-list .count {
    font-size: 0.85rem;
    opacity: 0.7;
    margin-left: var(--spacing-sm);
}

.tags-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
}

.tags-cloud a {
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--border-color);
    border-radius: var(--radius-sm);
    text-decoration: none;
    transition: background-color var(--transition-speed), color var(--transition-speed);
}

.tags-cloud a:hover {
    background: var(--accent-color);
    color: white;
    text-decoration: none;
}

.tag-size-1 { font-size: 0.8rem; }
.tag-size-2 { font-size: 0.9rem; }
.tag-size-3 { font-size: 1rem; }
.tag-size-4 { font-size: 1.1rem; }
.tag-size-5 { font-size: 1.2rem; }

/* Focus styles for accessibility */
*:focus-visible {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
}

/* Print styles */
@media print {
    nav, .breadcrumbs, .tags, footer {
        display: none;
    }

    body {
        max-width: none;
        padding: 0;
        color: black;
        background: white;
    }

    a {
        color: black;
        text-decoration: underline;
    }

    .content {
        max-width: 100%;
    }
}

/* Directories styling */
.top-level-links {
    border-left: 4px solid #4a88cf; /* Blue accent border */
    padding-left: 1rem;
}

.top-level-links-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 0.75rem;
}

.top-level-links-list li {
    margin-bottom: 0.5rem;
}

.top-level-links-list a {
    display: block;
    padding: 0.5rem;
}

</style></head>
<body>
    <header>
        <nav role="navigation" aria-label="Main navigation">
            <a href="/index.html">Home</a>
<a href="/categories/index.html">Categories</a>
<a href="/tags/index.html">Tags</a>
        </nav>
        <div class="breadcrumbs" role="navigation" aria-label="Breadcrumb">
            <a href="/index.html">Home</a> » <a href="/categories/database%20systems.html">Database Systems</a> » Storage and Retrieval Techniques for Database Systems
        </div>
    </header>
    <main role="main">
        <article>
            <h1>Storage and Retrieval Techniques for Database Systems</h1>
            <div class="meta">
                <time datetime="2025-01-01T04:29:39.285544">
                    Last modified: 2025-01-01
                </time>
                <span>Category: <a href="/categories/database%20systems.html">Database Systems</a></span>
            </div>
            <div class=markdown-content content>
                <h1 id="chapter-3">Chapter 3</h1>
<h2 id="storage-and-retrieval">Storage and Retrieval</h2>
<pre><code class="language-bash">#!/bin/bash

# instant database
db_set () {
 echo &quot;$1,$2&quot; &gt;&gt; database
}
db_get () {
 grep &quot;^$1,&quot; database | sed -e &quot;s/^$1,//&quot; | tail -n 1
}
</code></pre>
<p>The fact that it is a log makes this...sort of performant. Writes are fast O(1), and reads are slow O(n). The log-structured storage engine is a good fit for append-only workloads, such as event sourcing.</p>
<p>To make reads faster, we can use an <strong>index</strong>. An index is an additional structure that is derived from the primary data. This is a trade-off between write performance and read performance, since writes now have to update the index as well as the primary data.</p>
<h3 id="hash-indexes">Hash Indexes</h3>
<p>Map keys to offsets in the data file. This is fast for equality queries, but not for range queries. Store log-structured key-value data like above in binary format, and use a hash index to find the offset of the key in the data file. <strong>Delete</strong> by marking the key as deleted in the data file (sometimes with a "tombstone"), and periodically reindex the data file to remove the deleted keys.</p>
<p>For <strong>crash recovery</strong>:</p>
<ul>
<li>reread log file from beginning to end, building hash table indicies in memory (slow, but no additional storage)</li>
<li>store snapshots of the hash table indicies to disk periodically (fast, but requires additional storage)</li>
<li>use checksums to detect partial corruption of the hash table indicies (fast, but requires additional storage)</li>
</ul>
<p>For concurrency, maintain a single write thread, and multiple read threads. Writes are serialized, but reads can be parallelized.</p>
<h3 id="sstables-and-lsm-trees">SSTables and LSM-Trees</h3>
<p><strong>Sorted String Tables</strong> (SSTables) are a way to store key-value data in sorted order. Keep data sectioned based on time range, and search from most to least recent, periodically merging previous sections of data. Should store key value pairs, as well as byte offset metadata. Range queries are fast, and merge operations can be optimized by keeping most recent record and merging ranges at a time. However, both reading and writing are slower than hash indexes.</p>
<p>Can use B-Trees to store SSTables on disk, or various balanced binary trees (e.g. AVL, red-black, etc.) to store data in memory. These are called <strong>Log-Structured Merge Trees</strong> (LSM-Trees).</p>
<p>Below is a simplified version of the algorithm used by LevelDB, which is similar to the one used by Cassandra and HBase (which were inspired by Bigtable):</p>
<ul>
<li>When a write comes in, add it to an in-memory balanced tree data structure (memtable).</li>
<li>When the memtable gets bigger than some threshold, typically a few megabytes, write it out to disk as an SSTable file. While the SSTable is being written out to disk, writes can continue to a new memtable instance.</li>
<li>On read request, first try memtable, then in the most recent on-disk segment, then in the next-older segment, etc.</li>
<li>Periodically merge and coalesce segment files.</li>
</ul>
<p><strong>Lucene</strong> (used by Elasticsearch and Solr) uses a similar algorithm for its term-dictionary indexes that support full-text search. It uses a <strong>log-structured merge (LSM) tree</strong> to merge segments of the term dictionary. Here, words are the keys, and the values are the list of documents that contain the word (in a "Posting List"). This is kept in SSTables, and merged periodically.</p>
<h3 id="performance-optimizations">Performance Optimizations</h3>
<p><strong>Bloom filters</strong> are a way to avoid reading SSTables that don't contain a key. They are a memory-efficient data structure for approximating the contents of a set. Give false positives, but no false negatives. Can be used to avoid reading SSTables that don't contain a key.</p>
<p><strong>Merge strategies</strong> such as size-tiered, where segments are merged when they reach a certain size, or leveled, where segments are kept in subranges.</p>
<p>Keeping things append-only is a good way to keep throughput for writes high.</p>
<h3 id="b-trees-vs-lsm-trees">B-Trees vs LSM-Trees</h3>
<p>B-trees trade off write speed for read speed. N-ary tree with sorted keys in every node. Increase branch factor for maximal locality and minimal disk seeks.</p>
<p>LSM-trees trade off read speed for write speed. Writes are sequential, but reads are not. Writes are batched, and reads are parallelized. <strong>Write amplification</strong> (multiple writes to disk for a single DB write) can be a problem on both B-trees and LSM-trees. However, LSM-trees often still have a higher write throughput.</p>
<p>Compaction can impact LSM-tree read performance, but can be mitigated by keeping a small number of SSTables per level, and by using a merge strategy that does not require reading all SSTables. Still, it can impact high percentiles of read latency.</p>
<p>With high enough write throughput, it is also important to monitor disk space usage, since compaction can be slow enough that it doesn't keep up with the incoming writes.</p>
<h3 id="secondary-indexes">Secondary Indexes</h3>
<p><strong>Secondary indexes</strong> are indexes on non-primary keys. They can be implemented with hash indicies (still bad for range-queries), or with B-trees (good for range queries, but slower writes). They can also be implemented with LSM-trees. Similar to the setup for full-text search (Posting Lists), can use a list of matching records as a value in an index (<strong>inverted index</strong>).</p>
<h3 id="storing-indexes">Storing Indexes</h3>
<p>Must choose between storing references, or data directly in the index. Storing references is more space efficient update-friendly, but requires more disk seeks. Storing data directly in the index is more read friendly, but requires more disk space, and makes updates slower.</p>
<p><strong>Heap files</strong> let you store data referenced in your index and update in place when the new data fits in the space of the old data. Otherwise, you have to move the data to a new location, and update the index (or heap file with redirect pointer). However, this extra indirection can slow down reads.</p>
<p>Directly storing data in the index <strong>(clustered index)</strong> is good for read-heavy workloads, and storing references is good for write-heavy workloads. InnoDB (MySQL storage engine) uses a clustered index for primary keys, and a secondary index point directly to the primary key (instead of a heap file). SQLServer let you specify one clustered index per table.</p>
<p>B-trees are good for one-dimensional indexes, but not for <strong>multi-dimensional indexes</strong>. <strong>R-trees</strong> are a good alternative for multi-dimensional indexes, but are more complex.</p>
<p><strong>Fuzzy indexes</strong> are often used in full-text search. They are good for matching similar words, but not for exact matches. Lucene keeps an in-memory finite state automaton over characters in each key that is similar to a trie, allowing for fuzzy matching to a certain "edit distance".</p>
<h3 id="keeping-everything-in-memory">Keeping everything in memory</h3>
<p>As RAM gets cheaper, it makes more sense to keep data in memory. <strong>In-memory databases</strong> are good for applications that need low latency and high throughput, but make crash recovery more difficult. <strong>Write-ahead logs</strong> are a good way to make crash recovery easier, but can slow down writes. Some databases (e.g. Redis) let you choose between durability and performance, and have "weak durability" by asyncronously writing to disk. Some in-memory databases can even exceed the amount of RAM available by using an eviction policy similar to a cache.</p>
<h3 id="transaction-processing-or-analytics">Transaction Processing or Analytics?</h3>
<p><strong>OLTP</strong> (online transaction processing) is good for real-time stateful workloads, where low latency and high throughput are important. <strong>OLAP</strong> (online analytics processing) is good for async batch processing, where high throughput is important, but latency is not.</p>
<h4 id="otlp">OTLP:</h4>
<ul>
<li>transactional databases, relational databases, key-value stores, etc.</li>
<li>ACID transactions, concurrency control, indexes, etc.</li>
<li>enterprise typically made up of several OLTP systems that require high-availability and low-latency for reads and writes.</li>
</ul>
<h4 id="olap">OLAP:</h4>
<ul>
<li>data warehouses, batch processing, batch analytics, Hadoop, Spark, etc.</li>
<li>read only copy of data, typically loaded and queried in batches</li>
<li>typically used for business intelligence, reporting, and data mining. Not as critical to keep up and running 24/7, and queries are able to hog system resources without consequence.</li>
</ul>
<p>Most of the previous indexes are more OTLP focused, whereas "data warehouses" are more OLAP focused, and often use a different schema and index model.</p>
<h3 id="stars-and-snowflakes-schemas-for-analytics">Stars and Snowflakes: Schemas for Analytics</h3>
<p><strong>Star schema</strong> is a simple schema for OLAP. It has a single <strong>fact table</strong> containing all the records you want to query, and multiple <strong>dimension tables</strong> that contain the attributes you want to be queriable. The fact table contains foreign keys to the dimension tables.</p>
<p><strong>Snowflake schema</strong> is a more complex schema for OLAP. It is similar to a star schema, but the dimension tables are normalized into multiple tables. This can make queries more complex, but can also reduce storage space.</p>
<p>Warehouses can get huge (petabytes), since records are often events and are kept long term. Columns are often also very wide (100s of columns), since they are often denormalized.</p>
<h3 id="column-oriented-storage">Column-Oriented Storage</h3>
<pre><code class="language-sql">SELECT
 dim_date.weekday, dim_product.category,
 SUM(fact_sales.quantity) AS quantity_sold
FROM fact_sales
 JOIN dim_date ON fact_sales.date_key = dim_date.date_key
 JOIN dim_product ON fact_sales.product_sk = dim_product.product_sk
WHERE
 dim_date.year = 2013 AND
 dim_product.category IN ('Fresh fruit', 'Candy')
GROUP BY
 dim_date.weekday, dim_product.category;
</code></pre>
<p>In transactional databases, storage is "row-oriented", so an entire row needs to be loaded, including columns that aren't used. <strong>column-oriented</strong> storage is better for OLAP, since it only needs to load the columns that are used, which can amount to a lot of space over large datasets. It also allows for better compression, since columns are often similar.</p>
<p>Can be heavily compressed using bitmap indexes, and further by run-length encoding, delta encoding, etc. can also be optimized with vectorized processing (SIMD instructions), where instructions are executed in parallel on multiple values at once (<a href="https://courses.cs.washington.edu/courses/cse333/23au/lectures/27/code/cpp_simd_example.tar.gz">C++ example</a>).</p>
<h4 id="sort-order-in-column-storage">Sort Order in Column Storage</h4>
<p>Can choose a <strong>sort key</strong> to order rows in a column, and secondary sort key to break ties for a given value. Allows fast range queries, helps optimize compression (like with run length encoding for duplicates), and gives better locality for sequential reads.</p>
<p>Can even maintain several sort orders for a column, and choose the best one for a given query. This is called a <strong>compound sort key</strong>.</p>
<h4 id="writing-to-column-oriented-storage">Writing to Column-Oriented Storage</h4>
<p>These optimizations are good for reads and make sense in a data-warehouse, but can make writes slower because it has to update multiple indexes. This is fine for OLAP, and we can rely on LSM-trees to make writes fast initially, and periodically merge and compact the data.</p>
<h4 id="aggregation-data-cubes-and-materialized-views">Aggregation: Data Cubes and Materialized Views</h4>
<p><strong>Materialized views</strong> are precomputed joins and aggregations. They are good for speeding up queries, but can be expensive to maintain. They are often used in data warehouses, where the data is read-heavy, and the cost of maintaining the materialized views is amortized over many queries.</p>
<p><strong>Data cubes</strong> are a way to precompute aggregations over multiple dimensions. They are good for speeding up queries, but can be expensive to maintain. Essentially a multi-dimensional array, where each cell is an aggregation over a subset of the dimensions. Very expensive to maintain, and inflexible for queries that aren't covered by the precomputed aggregations.</p>
<p>Oftentimes, it makes more sense to store raw data, and then benchmark queries to see which ones are slow, and then precompute aggregations for those queries if they need to be faster.</p>
            </div>
            <div class="tags">
                Tags:
                <a href="/tags/column-oriented%20storage.html">column-oriented storage</a>
                <a href="/tags/data%20structures.html">data structures</a>
                <a href="/tags/indexing.html">indexing</a>
                <a href="/tags/oltp%20vs%20olap.html">oltp vs olap</a>
            </div>
        </article>
    </main>
    <footer role="contentinfo">
        <p>2025, authored by Elijah Melton.</p>
    </footer>
</body>
</html>
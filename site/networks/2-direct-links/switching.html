<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Switched Ethernet | Elijah's Notes</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Covers the implementation of switched Ethernet networks, including the use of bridging tables for MAC address forwarding, the distributed spanning tree algorithm for network topology discovery, and different switch architectures such as software switches and bare-metal switches. Discusses software-defined networking as an approach to managing and configuring Ethernet switches programmatically.">
    <meta name="author" content="Elijah Melton">
    <meta name="robots" content="index, follow">
    <meta name="generator" content="Custom Static Site Generator">
    <link rel="canonical" href="https://notes.elimelt.com/networks/2-direct-links/switching.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Switched Ethernet">
    <meta property="og:description" content="Covers the implementation of switched Ethernet networks, including the use of bridging tables for MAC address forwarding, the distributed spanning tree algorithm for network topology discovery, and different switch architectures such as software switches and bare-metal switches. Discusses software-defined networking as an approach to managing and configuring Ethernet switches programmatically.">
    <meta property="og:url" content="https://notes.elimelt.com/networks/2-direct-links/switching.html">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Switched Ethernet">
    <meta name="twitter:description" content="Covers the implementation of switched Ethernet networks, including the use of bridging tables for MAC address forwarding, the distributed spanning tree algorithm for network topology discovery, and different switch architectures such as software switches and bare-metal switches. Discusses software-defined networking as an approach to managing and configuring Ethernet switches programmatically.">

    <!-- Keywords from tags -->
    <meta name="keywords" content="ethernet,switching,mac address,forwarding table,bridge">

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {"@context": "https://schema.org", "@type": "Article", "headline": "Switched Ethernet", "dateModified": "2025-02-11T20:47:36.718632", "description": "Covers the implementation of switched Ethernet networks, including the use of bridging tables for MAC address forwarding, the distributed spanning tree algorithm for network topology discovery, and different switch architectures such as software switches and bare-metal switches. Discusses software-defined networking as an approach to managing and configuring Ethernet switches programmatically.", "articleSection": "Networks", "keywords": "ethernet,switching,mac address,forwarding table,bridge"}
    </script>
    <style>
        :root {
            --text-color: #1a1a1a;
            --background-color: #ffffff;
            --accent-color: #2563eb;
            --border-color: #e5e7eb;
            --nav-background: rgba(255, 255, 255, 0.95);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text-color: #f3f4f6;
                --background-color: #1a1a1a;
                --accent-color: #60a5fa;
                --border-color: #374151;
                --nav-background: rgba(26, 26, 26, 0.95);
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.6;
            max-width: 50rem;
            margin: 0 auto;
            padding: 2rem;
            color: var(--text-color);
            background: var(--background-color);
        }

        nav {
            position: sticky;
            top: 0;
            background: var(--nav-background);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
            margin-bottom: 2rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            z-index: 1000;
        }

        nav a {
            color: var(--accent-color);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        nav a:hover {
            background-color: var(--border-color);
        }

        .breadcrumbs {
            margin-bottom: 2rem;
            color: var(--text-color);
            opacity: 0.8;
        }

        .breadcrumbs a {
            color: var(--accent-color);
            text-decoration: none;
        }

        .content {
            margin-top: 2rem;
        }

        h1, h2, h3, h4, h5, h6 {
            margin-top: 2rem;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        code {
            background: var(--border-color);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
        }

        pre {
            background: var(--border-color);
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        pre code {
            background: none;
            padding: 0;
            border-radius: 0;
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            margin: 1.5rem 0;
        }

        .meta {
            color: var(--text-color);
            opacity: 0.8;
            font-size: 0.9em;
            margin-bottom: 2rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .tags {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .tags a {
            display: inline-block;
            background: var(--border-color);
            color: var(--text-color);
            padding: 0.2rem 0.6rem;
            border-radius: 3px;
            text-decoration: none;
            font-size: 0.9em;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .tags a:hover {
            background: var(--accent-color);
            color: white;
        }

        a {
            color: #3391ff;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        th, td {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
        }

        th {
            background: var(--border-color);
        }

        blockquote {
            margin: 1.5rem 0;
            padding-left: 1rem;
            border-left: 4px solid var(--accent-color);
            color: var(--text-color);
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <header>
        <nav role="navigation" aria-label="Main navigation">
            <a href="/index.html">Home</a>
<a href="/categories/index.html">Categories</a>
<a href="/tags/index.html">Tags</a>
        </nav>
        <div class="breadcrumbs" role="navigation" aria-label="Breadcrumb">
            <a href="/index.html">Home</a> » <a href="/categories/networks.html">Networks</a> » Switched Ethernet
        </div>
    </header>
    <main role="main">
        <article>
            <h1>Switched Ethernet</h1>
            <div class="meta">
                <time datetime="2025-02-11T20:47:36.718632">
                    Last modified: 2025-02-11
                </time>
                <span>Category: <a href="/categories/networks.html">Networks</a></span>
            </div>
            <div class="content">
                <h1 id="switching">Switching</h1>
<h2 id="switched-ethernet">Switched Ethernet</h2>
<p><strong>L2 Switches</strong> are used within enterprise and university networks to connect multiple devices on the same network. Historically, they were used as a "<em>bridge</em>" to connect multiple Ethernet segments, but are now typically used in a "<em>point-to-point</em>" configuration.</p>
<p><strong>Learning Switches</strong> are a type of L2 switch that learns the MAC addresses of devices connected to it. When a device sends a frame to the switch, the switch records the source MAC address and the port into its forwarding table. When a device sends a frame to the switch, the switch looks up the destination MAC address in its forwarding table and forwards the frame to the appropriate port. If the destination MAC address is not in the table, the switch floods the frame to all ports except the one it was received on.</p>
<pre><code class="language-c">#define BRIDGE_TAB_SIZE   1024  /* max size of bridging table */
#define MAX_TTL           120   /* time (in seconds) before an entry is flushed */

typedef struct {
    MacAddr     destination;    /* MAC address of a node */
    int         ifnumber;       /* interface to reach it */
    u_short     TTL;            /* time to live */
    Binding     binding;        /* binding in the Map */
} BridgeEntry;

int     numEntries = 0;
Map     bridgeMap = mapCreate(BRIDGE_TAB_SIZE, sizeof(BridgeEntry));

void
updateTable (MacAddr src, int inif)
{
    BridgeEntry       *b;

    if (mapResolve(bridgeMap, &amp;src, (void **)&amp;b) == FALSE )
    {
        /* this address is not in the table, so try to add it */
        if (numEntries &lt; BRIDGE_TAB_SIZE)
        {
            b = NEW(BridgeEntry);
            b-&gt;binding = mapBind( bridgeMap, &amp;src, b);
            /* use source address of packet as dest. address in table */
            b-&gt;destination = src;
            numEntries++;
        }
        else
        {
            /* can't fit this address in the table now, so give up */
            return;
        }
    }
    /* reset TTL and use most recent input interface */
    b-&gt;TTL = MAX_TTL;
    b-&gt;ifnumber = inif;
}
</code></pre>
<h3 id="distributed-spanning-tree-algorithm">Distributed Spanning Tree Algorithm</h3>
<p>Initially, all switches assume they are the root of the tree. Switches <em>broadcast</em> <strong>configuration messages</strong> that contain the `following:</p>
<ul>
<li>The ID of the sender</li>
<li>The ID for what the sender believes to be the root</li>
<li>The distance (in hops) of the sender to what the sender believes to be the root</li>
</ul>
<p>Each swtich listens to configuration messages being broadcasted, and remebers the "best" root it has seen. This is defined as:</p>
<ul>
<li>The lowest root ID</li>
<li>Equal root IDs, but lower distance</li>
<li>Equal root IDs and distances, but lower sender ID</li>
</ul>
<p>Once it identifies the best root, it adds one to the disance and broadcasts a configuration message with the new root and distance. If a switch realizes it isn't the root anymore, it stops broadcasting configuration messages and starts forwarding frames (still adding 1). Similarly, once a switch recieves a message that indicates a better path, it stops sending messages over that port.</p>
<p>Once the system stabilizes, the only the root will be sending configuration messages, and all other switches will be forwarding.</p>
<pre><code class="language-c">// Psuedo code for the distributed spanning tree algorithm

#define MAX_BRIDGES 1024

struct bridge {
    macaddr     root;       // ID of the root
    int     distance;       // distance to the root
    int     port;           // port to reach the root
    int     TTL;            // time to live
};

struct message {
    macaddr root;           // ID of the root (mac address)
    int     distance;       // distance to the root
    macaddr     sender;     // ID of the sender (mac address)
};

struct bridge bridges[MAX_BRIDGES];
struct message state;

void
update(struct message* m, int port)
{
    if (m-&gt;root &lt; state.root || (m-&gt;root == state.root &amp;&amp; m-&gt;distance &lt; state.distance))
    {
        state.root = m-&gt;root;
        state.distance = m-&gt;distance + 1;
        state.sender = m-&gt;sender;
        state.port = port;
    }
    else if (m-&gt;root == state.root &amp;&amp; m-&gt;distance == state.distance &amp;&amp; m-&gt;sender &lt; state.sender)
    {
        state.sender = m-&gt;sender;
        state.port = port;
    }
}

void
broadcast(struct message* m)
{
    for (int i = 0; i &lt; MAX_BRIDGES; i++)
        if (i != state.port)
            send(i, m);
}
</code></pre>
<h2 id="implementation">Implementation</h2>
<p>To create a switch, all you need to do is buy a general-purpose processor and equip it with multiple network interfaces. However, switches that deliver high-end performance typically take advantage of additional hardware acceleration. These are referred to as hardware switches, although both approaches obviously include a combination of hardware and software.</p>
<p>The implementation of switches and routers have so much in common that a network administrator typically buys a single forwarding box and then configures it to be an L2 switch, an L3 router, or some combination of the two.</p>
<h3 id="software-switches">Software Switches</h3>
<p>The performance of switches is limited by the need to pass packets through main memory. This can be a bottleneck, especially for short packets. The cost of processing each packet, such as parsing its header and making forwarding decisions, can also be a limiting factor. Non-trivial algorithms used by switches, like the spanning tree algorithm, are not directly part of the per-packet forwarding decision. Table lookups are often the most costly routine executed on a per-packet basis.</p>
<h3 id="bare-metal-switches">Bare-Metal Switches</h3>
<p>The distinction between the control plane (background processing) and the data plane (per-packet processing) is important. Recent advances in domain-specific processors have made it possible to build high-performance switches that combine the performance of ASICs with the agility of software. These switches can be programmed to be L2 switches, L3 routers, or a hybrid.</p>
<p>Bare-metal switches using Network Processing Units (NPUs) have become popular. NPUs are optimized for processing packet headers and making forwarding decisions. They can process packets at rates measured in Terabits per second (Tbps). The exact programming of an NPU depends on the chip vendor.</p>
<p>Internally, an NPU utilizes fast SRAM-based memory, TCAM-based memory for matching bit patterns, and a multi-stage forwarding pipeline. The use of a multi-stage pipeline allows for efficient packet processing and high throughput.</p>
<p>The networking industry is entering a commoditized world, similar to the computing industry, where standardized components and open source software are available for building high-performance switches.</p>
<h3 id="software-defined-networks">Software Defined Networks</h3>
<p>SDN (Software Defined Networks) decouples the network control plane from the data plane, allowing routing algorithms to run on software and packet forwarding decisions to be made by bare-metal switches. The standard interface between the control and data planes, known as OpenFlow, enables interoperability between different implementations. This concept of disaggregation has led to the trend of using commodity servers and bare-metal switches in network infrastructure.</p>
<p>Another important aspect of disaggregation is that a logically centralized control plane can be used to control a distributed network data plane. This allows for scalability and availability, as the two planes can be configured and scaled independently. Cloud providers have embraced this approach, using SDN-based solutions within their datacenters and across their backbone networks.</p>
<p>The Network Operating System (NOS) is a key enabler for SDN's success. It provides high-level abstractions and a Network Map to simplify network control functionality. The NOS detects changes in the network and the control application implements desired behavior on an abstract graph. By centralizing this logic, a globally optimized solution can be achieved.</p>
            </div>
            <div class='tags'>Tags: <a href="/tags/bridge.html">bridge</a>, <a href="/tags/ethernet.html">ethernet</a>, <a href="/tags/forwarding%20table.html">forwarding table</a>, <a href="/tags/mac%20address.html">mac address</a>, <a href="/tags/switching.html">switching</a></div>
        </article>
    </main>
    <footer role="contentinfo">
        <p>&copy; 2025 Your Site Name. All rights reserved.</p>
    </footer>
</body>
</html>